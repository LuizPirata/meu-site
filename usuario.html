<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Página do Usuário</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- MENU SUPERIOR -->
    <nav class="menu">
        <a href="perfil.html" class="menu-btn">Acompanhamento</a>
        <a href="simulacao.html" class="menu-btn">Simulação</a>
        <a href="classificacao.html" class="menu-btn">Classificação</a>
        <a href="artilharia.html" class="menu-btn">Artilharia</a>
        <a href="regras.html" class="menu-btn">Regras</a>
        <button id="logoutBtn" class="menu-btn logout-btn">Logout</button>
    </nav>

    <div class="container">
        <h1 id="titulo">Carregando...</h1>
        <p id="info">Buscando informações do usuário...</p>
    </div>

    <script type="module">
        import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

        const supabase = createClient(
            "https://mdaqzciffsgupzbfxzgf.supabase.co",
            "sb_publishable_5A4XlgwAjib2nde_qe5WQA_F9qCTghY"
        );

        // Lê o parâmetro da URL
        const params = new URLSearchParams(window.location.search);
        const username = params.get("user");

        async function carregarUsuario() {
            if (!username) {
                document.getElementById("titulo").textContent = "Usuário não encontrado";
                return;
            }

            const { data, error } = await supabase
                .from("usuarios")
                .select("*")
                .eq("username", username)
                .single();

            if (error || !data) {
                document.getElementById("titulo").textContent = "Usuário não encontrado";
                return;
            }

            document.getElementById("titulo").textContent = `Bem-vindo, ${data.username}!`;
            document.getElementById("info").textContent = `Seu email é: ${data.email}`;
        }

        carregarUsuario();

        // Botão de Logout remove sessão do supabase
        document.getElementById("logoutBtn").addEventListener("click", async () => {
            await supabase.auth.signOut();
            window.location.href = "index.html";
        });
    </script>

</body>
</html>
