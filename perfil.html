<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Meu Perfil - Palpites</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- MENU SUPERIOR PRINCIPAL -->
  <nav class="menu">
    <a href="perfil.html" class="menu-btn">Palpites</a>
    <a href="simulacao.html" class="menu-btn">Simulação</a>
    <a href="classificacao.html" class="menu-btn">Classificação</a>
    <a href="artilharia.html" class="menu-btn">Artilharia</a>
    <a href="regras.html" class="menu-btn">Regras</a>
    <button id="logoutBtn" class="menu-btn logout-btn">Logout</button>
  </nav>

  <!-- SUB-MENU DE GRUPOS (A–L) -->
  <div class="grupo-tabs">
    <button class="grupo-tab active" data-group="A">Grupo A</button>
    <button class="grupo-tab" data-group="B">Grupo B</button>
    <button class="grupo-tab" data-group="C">Grupo C</button>
    <button class="grupo-tab" data-group="D">Grupo D</button>
    <button class="grupo-tab" data-group="E">Grupo E</button>
    <button class="grupo-tab" data-group="F">Grupo F</button>
    <button class="grupo-tab" data-group="G">Grupo G</button>
    <button class="grupo-tab" data-group="H">Grupo H</button>
    <button class="grupo-tab" data-group="I">Grupo I</button>
    <button class="grupo-tab" data-group="J">Grupo J</button>
    <button class="grupo-tab" data-group="K">Grupo K</button>
    <button class="grupo-tab" data-group="L">Grupo L</button>
  </div>

  <!-- ===== GRUPO A (FUNCIONANDO COMPLETO) ===== -->
  <div id="grupo-A" class="grupo-pane active">

    <!-- TABELA GRUPO A -->
    <div class="grupo-container">
      <div class="grupo-header">Grupo A – Classificação</div>

      <table class="grupo-table">
        <thead>
          <tr>
            <th>Classificação</th>
            <th>P</th>
            <th>J</th>
            <th>V</th>
            <th>E</th>
            <th>D</th>
            <th>GF</th>
            <th>GC</th>
            <th>SG</th>
          </tr>
        </thead>
        <tbody id="tabela-grupoA-body">
          <!-- preenchido via JavaScript -->
        </tbody>
      </table>
    </div>

    <!-- RODADAS GRUPO A -->
    <div class="rodadas-container">

      <!-- 1ª Rodada -->
      <div class="rodada-coluna">
        <h3 class="rodada-titulo">1ª Rodada</h3>

        <div class="jogo-info">11/06/2026 – 16h – Estádio Azteca</div>
        <div class="jogo-linha">
          <img src="Mexico.png" class="flag-jogo">
          <span class="jogo-time">México</span>

          <div class="placar-input">
            <input type="number" min="0" class="gols-input" id="m1_home">
            <span class="x-separador">x</span>
            <input type="number" min="0" class="gols-input" id="m1_away">
          </div>

          <span class="jogo-time">África do Sul</span>
          <img src="africa.png" class="flag-jogo">
        </div>

        <div class="jogo-info">11/06/2026 – 23h – Estádio Akron</div>
        <div class="jogo-linha">
          <img src="coreia.png" class="flag-jogo">
          <span class="jogo-time">Coreia do Sul</span>

          <div class="placar-input">
            <input type="number" min="0" class="gols-input" id="m2_home">
            <span class="x-separador">x</span>
            <input type="number" min="0" class="gols-input" id="m2_away">
          </div>

          <span class="jogo-time">Europa D</span>
          <img src="europad.png" class="flag-jogo">
        </div>
      </div>

      <!-- 2ª Rodada -->
      <div class="rodada-coluna">
        <h3 class="rodada-titulo">2ª Rodada</h3>

        <div class="jogo-info">18/06/2026 – 13h – Estádio Atlanta</div>
        <div class="jogo-linha">
          <img src="europad.png" class="flag-jogo">
          <span class="jogo-time">Europa D</span>

          <div class="placar-input">
            <input type="number" min="0" class="gols-input" id="m3_home">
            <span class="x-separador">x</span>
            <input type="number" min="0" class="gols-input" id="m3_away">
          </div>

          <span class="jogo-time">África do Sul</span>
          <img src="africa.png" class="flag-jogo">
        </div>

        <div class="jogo-info">22/06/2026 – 22h – Estádio Akron</div>
        <div class="jogo-linha">
          <img src="Mexico.png" class="flag-jogo">
          <span class="jogo-time">México</span>

          <div class="placar-input">
            <input type="number" min="0" class="gols-input" id="m4_home">
            <span class="x-separador">x</span>
            <input type="number" min="0" class="gols-input" id="m4_away">
          </div>

          <span class="jogo-time">Coreia do Sul</span>
          <img src="coreia.png" class="flag-jogo">
        </div>
      </div>

      <!-- 3ª Rodada -->
      <div class="rodada-coluna">
        <h3 class="rodada-titulo">3ª Rodada</h3>

        <div class="jogo-info">24/06/2026 – 22h – Estádio Atlanta</div>
        <div class="jogo-linha">
          <img src="europad.png" class="flag-jogo">
          <span class="jogo-time">Europa D</span>

          <div class="placar-input">
            <input type="number" min="0" class="gols-input" id="m5_home">
            <span class="x-separador">x</span>
            <input type="number" min="0" class="gols-input" id="m5_away">
          </div>

          <span class="jogo-time">México</span>
          <img src="Mexico.png" class="flag-jogo">
        </div>

        <div class="jogo-info">24/06/2026 – 22h – Estádio El Gigante de Acero</div>
        <div class="jogo-linha">
          <img src="africa.png" class="flag-jogo">
          <span class="jogo-time">África do Sul</span>

          <div class="placar-input">
            <input type="number" min="0" class="gols-input" id="m6_home">
            <span class="x-separador">x</span>
            <input type="number" min="0" class="gols-input" id="m6_away">
          </div>

          <span class="jogo-time">Coreia do Sul</span>
          <img src="coreia.png" class="flag-jogo">
        </div>
      </div>

    </div> <!-- fim rodadas-container -->

  </div> <!-- fim grupo-A -->

<!-- ========================================= -->
<!-- GRUPO B - TABELA DE CLASSIFICAÇÃO -->
<!-- ========================================= -->

<div class="grupo-container">

    <div class="grupo-header">Grupo B - Tabela de Classificação</div>

    <table class="grupo-table">
        <thead>
            <tr>
                <th class="th-time">Time</th>
                <th>P</th>
                <th>J</th>
                <th>V</th>
                <th>E</th>
                <th>D</th>
                <th>GF</th>
                <th>GC</th>
                <th>SG</th>
            </tr>
        </thead>

        <tbody id="grupoB-body">

            <!-- 1º Canadá -->
            <tr>
                <td>
                    <div class="time-cell">
                        <span class="posicao">1º</span>
                        <img src="canada.png" class="flag">
                        <span class="time-nome">Canadá</span>
                    </div>
                </td>
                <td class="pontos">0</td>
                <td class="jogos">0</td>
                <td class="vitorias">0</td>
                <td class="empates">0</td>
                <td class="derrotas">0</td>
                <td class="gf">0</td>
                <td class="gc">0</td>
                <td class="sg">0</td>
            </tr>

            <!-- 2º Catar -->
            <tr>
                <td>
                    <div class="time-cell">
                        <span class="posicao">2º</span>
                        <img src="catar.png" class="flag">
                        <span class="time-nome">Catar</span>
                    </div>
                </td>
                <td class="pontos">0</td>
                <td class="jogos">0</td>
                <td class="vitorias">0</td>
                <td class="empates">0</td>
                <td class="derrotas">0</td>
                <td class="gf">0</td>
                <td class="gc">0</td>
                <td class="sg">0</td>
            </tr>

            <!-- 3º Europa A -->
            <tr>
                <td>
                    <div class="time-cell">
                        <span class="posicao">3º</span>
                        <img src="europad.png" class="flag">
                        <span class="time-nome">Europa A</span>
                    </div>
                </td>
                <td class="pontos">0</td>
                <td class="jogos">0</td>
                <td class="vitorias">0</td>
                <td class="empates">0</td>
                <td class="derrotas">0</td>
                <td class="gf">0</td>
                <td class="gc">0</td>
                <td class="sg">0</td>
            </tr>

            <!-- 4º Suíça -->
            <tr>
                <td>
                    <div class="time-cell">
                        <span class="posicao">4º</span>
                        <img src="suica.png" class="flag">
                        <span class="time-nome">Suíça</span>
                    </div>
                </td>
                <td class="pontos">0</td>
                <td class="jogos">0</td>
                <td class="vitorias">0</td>
                <td class="empates">0</td>
                <td class="derrotas">0</td>
                <td class="gf">0</td>
                <td class="gc">0</td>
                <td class="sg">0</td>
            </tr>

        </tbody>
    </table>
</div>

<!-- ========================================= -->
<!-- GRUPO B - RODADAS / CONFRONTOS -->
<!-- ========================================= -->

<div class="rodadas-container">

    <!-- 1ª Rodada -->
    <div class="rodada-coluna">
        <h3 class="rodada-titulo">1ª Rodada</h3>

        <!-- Canadá x Europa A -->
        <div class="jogo-info">12/06/2026 – 16h – Toronto Field</div>
        <div class="jogo-linha">
            <img src="canada.png" class="flag-jogo">
            <span class="jogo-time">Canadá</span>

            <div class="placar-input">
                <input type="number" class="gols-input" data-jogo="B1" data-time="canada">
                <span class="x-separador">x</span>
                <input type="number" class="gols-input" data-jogo="B1" data-time="europaa">
            </div>

            <span class="jogo-time">Europa A</span>
            <img src="europad.png" class="flag-jogo">
        </div>

        <!-- Catar x Suíça -->
        <div class="jogo-info">13/06/2026 – 16h – Santa Clara</div>
        <div class="jogo-linha">
            <img src="catar.png" class="flag-jogo">
            <span class="jogo-time">Catar</span>

            <div class="placar-input">
                <input type="number" class="gols-input" data-jogo="B2" data-time="catar">
                <span class="x-separador">x</span>
                <input type="number" class="gols-input" data-jogo="B2" data-time="suica">
            </div>

            <span class="jogo-time">Suíça</span>
            <img src="suica.png" class="flag-jogo">
        </div>
    </div>

    <!-- 2ª Rodada -->
    <div class="rodada-coluna">
        <h3 class="rodada-titulo">2ª Rodada</h3>

        <!-- Suíça x Europa A -->
        <div class="jogo-info">18/06/2026 – 16h – Los Angeles</div>
        <div class="jogo-linha">
            <img src="suica.png" class="flag-jogo">
            <span class="jogo-time">Suíça</span>

            <div class="placar-input">
                <input type="number" class="gols-input" data-jogo="B3" data-time="suica">
                <span class="x-separador">x</span>
                <input type="number" class="gols-input" data-jogo="B3" data-time="europaa">
            </div>

            <span class="jogo-time">Europa A</span>
            <img src="europad.png" class="flag-jogo">
        </div>

        <!-- Canadá x Catar -->
        <div class="jogo-info">18/06/2026 – 19h – Vancouver Place</div>
        <div class="jogo-linha">
            <img src="canada.png" class="flag-jogo">
            <span class="jogo-time">Canadá</span>

            <div class="placar-input">
                <input type="number" class="gols-input" data-jogo="B4" data-time="canada">
                <span class="x-separador">x</span>
                <input type="number" class="gols-input" data-jogo="B4" data-time="catar">
            </div>

            <span class="jogo-time">Catar</span>
            <img src="catar.png" class="flag-jogo">
        </div>
    </div>

    <!-- 3ª Rodada -->
    <div class="rodada-coluna">
        <h3 class="rodada-titulo">3ª Rodada</h3>

        <!-- Suíça x Canadá -->
        <div class="jogo-info">24/06/2026 – 16h – Vancouver Place</div>
        <div class="jogo-linha">
            <img src="suica.png" class="flag-jogo">
            <span class="jogo-time">Suíça</span>

            <div class="placar-input">
                <input type="number" class="gols-input" data-jogo="B5" data-time="suica">
                <span class="x-separador">x</span>
                <input type="number" class="gols-input" data-jogo="B5" data-time="canada">
            </div>

            <span class="jogo-time">Canadá</span>
            <img src="canada.png" class="flag-jogo">
        </div>

        <!-- Europa A x Catar -->
        <div class="jogo-info">24/06/2026 – 16h – Seattle Field</div>
        <div class="jogo-linha">
            <img src="europad.png" class="flag-jogo">
            <span class="jogo-time">Europa A</span>

            <div class="placar-input">
                <input type="number" class="gols-input" data-jogo="B6" data-time="europaa">
                <span class="x-separador">x</span>
                <input type="number" class="gols-input" data-jogo="B6" data-time="catar">
            </div>

            <span class="jogo-time">Catar</span>
            <img src="catar.png" class="flag-jogo">
        </div>
    </div>

</div>

 </div> <!-- fim rodadas-container -->

  </div> <!-- fim grupo-B -->


  <!-- ===== GRUPO B–L (POR ENQUANTO APENAS PLACEHOLDER VISUAL) ===== -->

  <div id="grupo-B" class="grupo-pane">
    <h2 class="grupo-placeholder">Grupo B – em construção</h2>
  </div>

  <div id="grupo-C" class="grupo-pane">
    <h2 class="grupo-placeholder">Grupo C – em construção</h2>
  </div>

  <div id="grupo-D" class="grupo-pane">
    <h2 class="grupo-placeholder">Grupo D – em construção</h2>
  </div>

  <div id="grupo-E" class="grupo-pane">
    <h2 class="grupo-placeholder">Grupo E – em construção</h2>
  </div>

  <div id="grupo-F" class="grupo-pane">
    <h2 class="grupo-placeholder">Grupo F – em construção</h2>
  </div>

  <div id="grupo-G" class="grupo-pane">
    <h2 class="grupo-placeholder">Grupo G – em construção</h2>
  </div>

  <div id="grupo-H" class="grupo-pane">
    <h2 class="grupo-placeholder">Grupo H – em construção</h2>
  </div>

  <div id="grupo-I" class="grupo-pane">
    <h2 class="grupo-placeholder">Grupo I – em construção</h2>
  </div>

  <div id="grupo-J" class="grupo-pane">
    <h2 class="grupo-placeholder">Grupo J – em construção</h2>
  </div>

  <div id="grupo-K" class="grupo-pane">
    <h2 class="grupo-placeholder">Grupo K – em construção</h2>
  </div>

  <div id="grupo-L" class="grupo-pane">
    <h2 class="grupo-placeholder">Grupo L – em construção</h2>
  </div>

  <!-- ========== SCRIPT: SUPABASE + TABELA GRUPO A + TABS DE GRUPO ========== -->
  <script type="module">
    import { createClient } from "https://esm.sh/@supabase/supabase-js";

    // ---------- SUPABASE (login / logout) ----------
    const SUPABASE_URL = "https://mdaqzciffsgupzbfxzgf.supabase.co";
    const SUPABASE_ANON_KEY = "sb_publishable_5A4XlgwAjib2nde_qe5WQA_F9qCTghY";

    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // Verificar se o usuário está logado
    const {
      data: { session }
    } = await supabase.auth.getSession();

    if (!session) {
      window.location.href = "index.html";
    }

    // Logout
    document.getElementById("logoutBtn").addEventListener("click", async () => {
      await supabase.auth.signOut();
      window.location.href = "index.html";
    });

    // ---------- SELETOR DE GRUPOS (TABS) ----------
    const tabs = document.querySelectorAll(".grupo-tab");
    const panes = document.querySelectorAll(".grupo-pane");

    tabs.forEach(tab => {
      tab.addEventListener("click", () => {
        const group = tab.getAttribute("data-group");

        // botão ativo
        tabs.forEach(t => t.classList.remove("active"));
        tab.classList.add("active");

        // mostrar/esconder painéis
        panes.forEach(p => {
          if (p.id === "grupo-" + group) {
            p.classList.add("active");
          } else {
            p.classList.remove("active");
          }
        });
      });
    });

    // ---------- TABELA DO GRUPO A (AUTOMÁTICA) ----------

    // Times do grupo A
    const teamsA = [
      { id: "mex", name: "México",       flag: "Mexico.png" },
      { id: "afs", name: "África do Sul", flag: "africa.png" },
      { id: "cor", name: "Coreia do Sul", flag: "coreia.png" },
      { id: "eur", name: "Europa D",      flag: "europad.png" }
    ];

    // Partidas do grupo A (linkadas aos IDs dos inputs)
    const matchesA = [
      { id: "m1", home: "mex", away: "afs", homeInputId: "m1_home", awayInputId: "m1_away" },
      { id: "m2", home: "cor", away: "eur", homeInputId: "m2_home", awayInputId: "m2_away" },
      { id: "m3", home: "eur", away: "afs", homeInputId: "m3_home", awayInputId: "m3_away" },
      { id: "m4", home: "mex", away: "cor", homeInputId: "m4_home", awayInputId: "m4_away" },
      { id: "m5", home: "eur", away: "mex", homeInputId: "m5_home", awayInputId: "m5_away" },
      { id: "m6", home: "afs", away: "cor", homeInputId: "m6_home", awayInputId: "m6_away" }
    ];

    const tabelaBodyA = document.getElementById("tabela-grupoA-body");

    // Cria estrutura base de estatísticas
    function createEmptyStatsA() {
      const stats = {};
      teamsA.forEach(t => {
        stats[t.id] = {
          id: t.id,
          name: t.name,
          flag: t.flag,
          pts: 0,
          j: 0,
          v: 0,
          e: 0,
          d: 0,
          gf: 0,
          gc: 0,
          sg: 0,
          h2h: {} // head-to-head
        };
      });
      return stats;
    }

    // Recalcula tudo para o Grupo A
    function recalcularTabelaA() {
      const stats = createEmptyStatsA();

      // Processar cada jogo
      for (const match of matchesA) {
        const homeInput = document.getElementById(match.homeInputId);
        const awayInput = document.getElementById(match.awayInputId);
        if (!homeInput || !awayInput) continue;

        const homeVal = homeInput.value.trim();
        const awayVal = awayInput.value.trim();

        if (homeVal === "" || awayVal === "") continue;

        const gh = parseInt(homeVal, 10);
        const ga = parseInt(awayVal, 10);
        if (Number.isNaN(gh) || Number.isNaN(ga)) continue;

        const home = stats[match.home];
        const away = stats[match.away];

        home.j++;
        away.j++;

        home.gf += gh;
        home.gc += ga;
        away.gf += ga;
        away.gc += gh;

        let homePts = 0;
        let awayPts = 0;

        if (gh > ga) {
          home.v++;
          away.d++;
          homePts = 3;
        } else if (gh < ga) {
          away.v++;
          home.d++;
          awayPts = 3;
        } else {
          home.e++;
          away.e++;
          homePts = 1;
          awayPts = 1;
        }

        home.pts += homePts;
        away.pts += awayPts;

        // head-to-head
        if (!home.h2h[match.away]) {
          home.h2h[match.away] = { gf: 0, ga: 0, pts: 0 };
        }
        if (!away.h2h[match.home]) {
          away.h2h[match.home] = { gf: 0, ga: 0, pts: 0 };
        }

        home.h2h[match.away].gf += gh;
        home.h2h[match.away].ga += ga;
        home.h2h[match.away].pts += homePts;

        away.h2h[match.home].gf += ga;
        away.h2h[match.home].ga += gh;
        away.h2h[match.home].pts += awayPts;
      }

      // saldo de gols
      for (const t of Object.values(stats)) {
        t.sg = t.gf - t.gc;
      }

      // ordenação geral inicial
      let order = teamsA.map(t => t.id);
      order.sort((aId, bId) => {
        const a = stats[aId];
        const b = stats[bId];
        if (b.pts !== a.pts) return b.pts - a.pts;
        if (b.sg !== a.sg) return b.sg - a.sg;
        if (b.gf !== a.gf) return b.gf - a.gf;
        return 0;
      });

      // aplica confronto direto
      order = aplicarConfrontoDiretoA(order, stats);

      // renderizar
      renderTabelaA(order, stats);
    }

    // Confronto direto (mini-tabela) Grupo A
    function aplicarConfrontoDiretoA(order, stats) {
      const finalOrder = [];
      let i = 0;

      while (i < order.length) {
        let j = i + 1;

        while (j < order.length) {
          const a = stats[order[i]];
          const b = stats[order[j]];
          if (a.pts === b.pts && a.sg === b.sg && a.gf === b.gf) {
            j++;
          } else {
            break;
          }
        }

        const grupoEmpatado = order.slice(i, j);

        if (grupoEmpatado.length === 1) {
          finalOrder.push(grupoEmpatado[0]);
        } else {
          const mini = grupoEmpatado.map(id => {
            const st = stats[id];
            let pts = 0;
            let sg = 0;
            let gf = 0;

            for (const outroId of grupoEmpatado) {
              if (outroId === id) continue;
              const h = st.h2h[outroId];
              if (!h) continue;
              pts += h.pts;
              sg += h.gf - h.ga;
              gf += h.gf;
            }

            return { id, pts, sg, gf };
          });

          mini.sort((a, b) => {
            if (b.pts !== a.pts) return b.pts - a.pts;
            if (b.sg !== a.sg) return b.sg - a.sg;
            if (b.gf !== a.gf) return b.gf - a.gf;
            return grupoEmpatado.indexOf(a.id) - grupoEmpatado.indexOf(b.id);
          });

          finalOrder.push(...mini.map(m => m.id));
        }

        i = j;
      }

      return finalOrder;
    }

    // Desenha tabela no HTML (Grupo A)
    function renderTabelaA(order, stats) {
      tabelaBodyA.innerHTML = "";

      order.forEach((teamId, index) => {
        const st = stats[teamId];
        const meta = teamsA.find(t => t.id === teamId);
        const pos = index + 1;

        const tr = document.createElement("tr");

        const tdTeam = document.createElement("td");
        tdTeam.className = "time-cell";
        tdTeam.innerHTML = `
          <span class="posicao">${pos}º</span>
          <img src="${meta.flag}" class="flag" alt="${meta.name}">
          <span class="time-nome">${meta.name}</span>
        `;

        const tdP  = document.createElement("td");
        const tdJ  = document.createElement("td");
        const tdV  = document.createElement("td");
        const tdE  = document.createElement("td");
        const tdD  = document.createElement("td");
        const tdGF = document.createElement("td");
        const tdGC = document.createElement("td");
        const tdSG = document.createElement("td");

        tdP.textContent  = st.pts;
        tdJ.textContent  = st.j;
        tdV.textContent  = st.v;
        tdE.textContent  = st.e;
        tdD.textContent  = st.d;
        tdGF.textContent = st.gf;
        tdGC.textContent = st.gc;
        tdSG.textContent = st.sg;

        tr.appendChild(tdTeam);
        tr.appendChild(tdP);
        tr.appendChild(tdJ);
        tr.appendChild(tdV);
        tr.appendChild(tdE);
        tr.appendChild(tdD);
        tr.appendChild(tdGF);
        tr.appendChild(tdGC);
        tr.appendChild(tdSG);

        tabelaBodyA.appendChild(tr);
      });
    }

    // Ligar eventos nos inputs do Grupo A
    function initListenersA() {
      matchesA.forEach(match => {
        const homeInput = document.getElementById(match.homeInputId);
        const awayInput = document.getElementById(match.awayInputId);
        if (!homeInput || !awayInput) return;

        homeInput.addEventListener("input", recalcularTabelaA);
        awayInput.addEventListener("input", recalcularTabelaA);
      });

      recalcularTabelaA();
    }

    initListenersA();
  </script>

</body>
</html>


